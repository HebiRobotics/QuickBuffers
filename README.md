# RoboBuffers - Protocol Buffers without Allocations

RoboBuffers is a Java implementation of Google's Protocol Buffers v2 that can be used in real-time applications and allocation-constrained environments.

## Generating Messages

The code generator is setup as a `protoc` plugin. In order to call it, you need to

* Place `protoc-gen-robobuf`, `protoc-gen-robobuf.bat`, and `protoc-gen-robobuf-<version>.jar` in a directory on the `$PATH`
* Call `protoc` with `--robobuf_out=<options>:./path/to/generate`

### Generator Options

Currently available options are

* **indent** = `2`|`4`|`8`|`tab` (Sets the indentation in generated files. Default = 2)
* **replacePackage** = `regex|replacement` (Allows replacing the Java package to avoid name collisions with messages generated by `--java_out`)


For example, `--robobuf_out=indent=4,replacePackage=us.hebi.java|us.hebi.robo:./path/to/generate`.

## Usage

All nested reference types are `final` and allocated beforehand. They can be accessed via `getField()` or `getMutableField()` accessors. `getMutableField()` returns the internal field, and also sets the appropriate has-bit.

```java
// TODO: sample code
```

Most of the public API tries to stay compatible with the official Java bindings offered by Google.

## Repository

```xml
<!-- TODO: upload to maven central -->
```

## Developer Info

Protoc plugins get called by `protoc` and exchange information via protobuf messages on `std::in` and `std::out`. While this makes it fairly simple to get the schema information, it makes it quite difficult to debug plugins or setup unit tests.

To work around this, the `parser` module contains a tiny protoc-plugin that stores the raw request from `std::in` inside a file that can be loaded in unit tests during development.

The `compiler` module contains the actual protoc-plugin and code generator. The `runtime` module contains the runtime libraries needed when using the generated messages. The `benchmark` module contains performance benchmarks in order to test performance implications of different strategies.


## Acknowledgements

The serialization and deserialization code is heavily based on Google's no longer supported `Protobuf-JavaNano` implementation. The Utf8 related methods were adapted from `Guava/Flatbuffers`.